<% provide :title, @item.title %>
<% provide :body_id, 'items_show' %>

<% case session[:browse_context] %>
  <% when ItemsController::BrowseContext::SEARCHING %>
    <ol class="breadcrumb">
      <li><%= link_to 'Home', root_path %></li>
      <li><%= link_to 'Search', session[:browse_context_url] %></li>
      <% if @item.parent %>
        <li><%= link_to @item.parent.title, @item.parent %></li>
      <% end %>
      <li class="active"><%= truncate(@item.title, length: 50) %></li>
    </ol>
  <% when ItemsController::BrowseContext::BROWSING_ALL_ITEMS %>
    <ol class="breadcrumb">
      <li><%= link_to 'Home', root_path %></li>
      <li><%= link_to 'All Items', repository_items_path %></li>
      <% if @item.parent %>
        <li><%= link_to @item.parent.title, @item.parent %></li>
      <% end %>
      <li class="active"><%= truncate(@item.title, length: 50) %></li>
    </ol>
  <% when ItemsController::BrowseContext::FAVORITES %>
    <ol class="breadcrumb">
      <li><%= link_to 'Home', root_path %></li>
      <li><%= link_to 'Favorites', favorites_path %></li>
      <% if @item.parent %>
          <li><%= link_to @item.parent.title, @item.parent %></li>
      <% end %>
      <li class="active"><%= truncate(@item.title, length: 50) %></li>
    </ol>
  <% else %>
    <ol class="breadcrumb">
      <li><%= link_to 'Home', root_path %></li>
      <li><%= link_to 'Collections', repository_collections_path %></li>
      <li><%= link_to @item.collection.title, @item.collection %></li>
      <% if @item.parent %>
        <li><%= link_to @item.parent.title, @item.parent %></li>
      <% end %>
      <li class="active"><%= truncate(@item.title, length: 50) %></li>
    </ol>
<% end %>

<div class="btn-group pull-right">
  <button class="btn btn-danger kq-remove-from-favorites"
          data-web-id="<%= @item.web_id %>">
    <i class="fa fa-heart-o"></i> Remove From Favorites
  </button>
  <button class="btn btn-default kq-add-to-favorites"
          data-web-id="<%= @item.web_id %>">
    <i class="fa fa-heart"></i> Add To Favorites
  </button>
  <%= share_button(@item) %>
  <%= download_button(@item) %>
</div>

<% if @item.parent.kind_of?(Repository::Item) %>
  <h1 class="kq-compound-title">
    <small><%= link_to @item.parent.title, @item.parent %></small>
    <br>&nbsp;&nbsp;&#8627; <%= @item.title %>
  </h1>
<% else %>
  <h1><%= @item.title %>
    <% if @item.subtitle %>
      <br><small><%= @item.subtitle %></small>
    <% end %>
  </h1>
<% end %>

<%= viewer_for(@item) %>

<% if @item.full_text.present? %>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">Full Text</h2>
    </div>
    <div class="panel-body">
      <pre><%= @item.full_text %></pre>
    </div>
  </div>
<% end %>

<% if @pages.any? %>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">Pages (<%= @pages.length %>)</h2>
    </div>
    <div class="panel-body kq-horizontal-items">
      <%= pages_as_list(@item) %>
    </div>
  </div>
<% end %>

<div class="row">

  <div class="col-sm-9">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h2 class="panel-title">Descriptive Info</h2>
      </div>
      <div class="panel-body">
        <%= triples_to_dl(@item) %>
      </div>
    </div>
  </div>

  <div class="col-sm-3">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h2 class="panel-title">Similar Items</h2>
      </div>
      <div class="panel-body kq-vertical-items">
        <%= similar_items_as_list(@item) %>
      </div>
    </div>
  </div>

</div>

<% if Rails.env.development? %>
  <!-- Repository URL: <%= link_to @item.repository_url, @item.repository_url %> -->
<% end %>
